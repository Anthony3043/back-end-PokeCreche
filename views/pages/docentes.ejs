<% const currentPage = 'docentes' %>

<div class="balao-principal">
    <h1>Cadastro do Docente</h1>

    <div class="balao-topo">
        <button type="button" class="botao-Aluno <%= currentPage === 'alunos' ? 'active' : '' %>" 
                onclick="location.href='/alunos'">Aluno</button>
        <button type="button" class="botao-Professor <%= currentPage === 'docentes' ? 'active' : '' %>" 
                onclick="location.href='/docentes'">Docente</button>
    </div>

    <div class="balao-interno">
        <form id="form-docente" action="#" method="post">
            <input type="text" placeholder="Nome" name="nome" required />
            <input type="text" placeholder="Identificador" name="identificador" required />
            <input type="password" placeholder="Senha" name="senha" required />

            <button type="submit" class="btn-submit">Cadastrar</button>
        </form>
        
        <div id="message-docente" class="message"></div>
    </div>
</div>

<script>
    const baseUrl = '<%= baseUrl %>';
    
    document.getElementById('form-docente').addEventListener('submit', async function (e) {
        e.preventDefault();
        const form = e.target;
        const btn = form.querySelector('.btn-submit');
        const messageDiv = document.getElementById('message-docente');
        
        btn.disabled = true;
        btn.textContent = 'Enviando...';
        messageDiv.innerHTML = '';
        
        const data = {
            nome: form.nome.value.trim(),
            identificador: form.identificador.value.trim(),
            senha: form.senha.value
        };

        try {
            const res = await fetch(baseUrl + '/register/docente', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            
            const json = await res.json();
            
            if (res.ok) {
                messageDiv.innerHTML = `<div class="success">✅ ${json.message || 'Docente cadastrado com sucesso!'}</div>`;
                form.reset();
            } else {
                throw json;
            }
        } catch (err) {
            messageDiv.innerHTML = `<div class="error">❌ ${err.message || 'Erro ao cadastrar docente'}</div>`;
        } finally {
            btn.disabled = false;
            btn.textContent = 'Cadastrar';
        }
    });
</script>